# ecs273-team08-CrimeAnalysis
Interactive Crime Visualization and Insights System for San Francisco

## Description
This repository provides an interactive system that visualizes San Francisco crime data using heatmaps and bar charts, categorized by crime type. Users can select any date to view crime trends for the past 30 days. To support deeper understanding and better decision-making, the system integrates insights from a large language model (LLM).

![image](https://github.com/user-attachments/assets/f69dda93-845d-40a4-8ebf-0ba7ccb726b2)

Key features include:
- **Visualizations**: Crime categories displayed via heatmaps and bar charts based on recent 30-day data.
- **Analysis Explaination supported by LLM**: The system provides data-driven explanations and actionable advice generated by a large language model (LLM). These insights are based on statistical trend analysis and five relevant news articles retrieved from Google News within the selected time frame.
- **Accessible to Non-Experts**: Designed for use by community members, public officials, and police departments, the system helps users easily interpret crime trends and supports informed decisions such as patrol planning.

## Installation

### Prerequisites
- Python 3.11+
- Node.js 18+
- MongoDB 7.0
- Homebrew (for macOS users)

### Project Structure
```
.
├── data_preprocessing/     # Data processing scripts
├── web_app/
│   ├── frontend/          # D3 frontend
│   └── backend/           # FastAPI backend
├── requirements.txt       # Python dependencies
├── .env sample
└── README.md
```

### 1. MongoDB Setup

For macOS users (using Homebrew):
```bash
# Install MongoDB
brew tap mongodb/brew
brew install mongodb-community@7.0
```


### 2.Backend Setup

#### Environment Variables
Copy the .env.example template and fill in required values 
```
cp .env.example .env

```

You need open ai api key to run this system. [Detail](https://platform.openai.com/api-keys)

#### Virtual Envioroments
```zsh
#if necessary
# install correct Python version
pyenv install 3.11.8
pyenv local 3.11.8

# Create and activate virtual environment
python -m venv .venv
source .venv/bin/activate  # For Unix/macOS


# Install Python dependencies
pip install -r requirements.txt
```



deactivate virtual environment
```zsh
deactivate
```


### 3. Set Data
1. Start MongoDB service:
   ```zsh
   # For macOS
   brew services start mongodb-community
   ```

2. Verify MongoDB is running:
   ```zsh
   mongosh
   ```

3. Import crime data to MongoDB:
   ```zsh

   # Run the main data pipeline
   python data_preprocessing/crime_data_pipeline.py

   # Navigate to the import script directory
   cd web_app/backend/utils
   
   # Run the import script from the csv file
   python import_data.py
   ```

4. Verify data import:
   ```zsh
   # Connect to MongoDB shell
   mongosh
   
   # Switch to crime_forecast database
   use crime_forecast
   
   # Check the number of imported records
   db.incidents.count()
   ```

## Excution 
### 1. Backend Setup & Run

1. Navigate to backend directory:
   ```zsh
   cd web_app/backend
   ```


2. Run the backend server:
   ```bash
   uvicorn app:app --reload --port 8001
   ```

The backend will be available at `http://localhost:8001`

### 2. Frontend Setup & Run

1. Navigate to frontend directory:
   ```zsh
   cd web_app/frontend
   ```

2. Install dependencies:
   ```zsh
   npm install
   ```

3. Run the development server:
   ```zsh
   npm run dev
   ```

The frontend will be available at `http://localhost:5173`

### 3. Accessing the Application

1. Open your browser and visit `http://localhost:5173`
   
2. Select the date

3. The application should now show the following items for previous 30days:
   - Heatmap visualization by Crime categotry
   - Bar Chart by Crime category
   - Related news selected by LLM and LLM advice
![image](https://github.com/user-attachments/assets/cbdea3d9-bc62-448c-8b86-a25afc2f98cc)
![image](https://github.com/user-attachments/assets/c24f8328-2b8b-49aa-bd59-e53b94a51d0f)


## AI Use 
AI was used as a supportive tool throughout the development process, primarily for the following purposes:

- Formatting and structuring exsiting code
- Enhancing commentout and documentation
- Optimizing prompts for LLM API call
- Assisting with debugging, especially in CSS and UI styling

